\documentclass[aspectratio=169, usenames, dvipsnames]{beamer}
\usetheme{metropolis}
\metroset{block=fill}

\usepackage{newpxtext}
\usepackage{newpxmath}

\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{physics}
\usepackage{ragged2e}
\usepackage{filecontents}
\usepackage{xcolor}

\usepackage[binary-units]{siunitx}
\DeclareSIUnit\flops{FLOPS}
\DeclareSIUnit\year{yr}

\usepackage{pgfplots}
\pgfplotsset{width=\textwidth, height=0.494427\textwidth}

\usepackage{tikz}
\usepackage{mathtools}
\usetikzlibrary{positioning, shapes.geometric, arrows, arrows.meta, spy, shadows, mindmap, calc}
\usepgfplotslibrary{colorbrewer}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;} 

\usefonttheme{serif}

\title{Optically-Active Media}
\subtitle{The QuEST for light-matter models}
\date{December 20, 2017}
\author{Connor Glosser}
\institute{Michigan State University, Physics \& Electrical Engineering}

\newcommand{\oper}[1]{\mathcal{#1}}
\newcommand{\rwoper}[1]{\tilde{\mathcal{#1}}}
\newcommand{\outerprod}[2]{#1 \! \otimes \! #2}

\begin{document}

\maketitle

\section{Computational electromagnetics}

\begin{frame}{Why electromagnetics?}
  \only<1>{
    \begin{columns}
      \column{0.3\textwidth}
        \centering
        \includegraphics[height=0.7\textheight]{figures/cell_phone}

      \column{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/weather_radar}

      \column{0.3\textwidth}
        \centering
        \includegraphics[width=\textwidth]{figures/Sigma_invader_RCS}
    \end{columns}
  }
  \only<2>{
    \begin{center}
      \includegraphics[width=0.7\textwidth]{figures/auto-systems04}
    \end{center}
  }
\end{frame}

\begin{frame}{Why \emph{computational} electromagnetics?}
  \begin{columns}
    \column{0.5\textwidth}
      \begin{itemize}
        \item Maxwell's equations govern electromagnetic phenomena
          \begin{itemize}
            \item Radar, antennas, optics, telecommunications, \ldots
          \end{itemize}
        \item Analytic solutions unavailable for all but simplest geometries
        \item Simulate!
          \begin{itemize}
            \item How to represent \emph{equations} discretely?
            \item How to represent \emph{boundary conditions} discretely?
            \item Algorithmic complexity?
            \item Precision?
          \end{itemize}
      \end{itemize}
    \column{0.5\textwidth}
    \begin{center}
      \includegraphics[width=0.7\textwidth]{figures/aircraft}
      \vspace{0.3cm}
      \begin{block}{Maxwell's equations}
        \begin{gather*}
          \div \vb{E} = 4 \pi k_1 \rho \qquad \curl \vb{E} = -k_3 \pdv{\vb{B}}{t} \\
          \curl \vb{B} = 4 \pi k_2 \alpha \vb{J} + \frac{k_2 \alpha}{k_1} \pdv{\vb{E}}{t} \qquad \div \vb{B} = 0
        \end{gather*}
      \end{block}
    \end{center}
  \end{columns}
\end{frame}

\begin{frame}{Problem statement}
  \begin{columns}
    \column{0.6\textwidth}
      Given
      \begin{center}
        geometry, material data, excitation
      \end{center}
      determine
      \begin{center}
        near and far fields, impedances, coupling
      \end{center}
      in the
      \begin{center}
        time or frequency domain.
      \end{center}

    \column{0.4\textwidth}
      \centering
      \begin{tikzpicture}
        \node at (0,0) {\includegraphics[width=0.5\textwidth]{figures/dielectric}};
        \node at (2, -2.5) {\includegraphics[width=0.5\textwidth]{figures/Dolphin_triangle_mesh}};
        \node at (-1, -4.0) {\includegraphics[width=0.5\textwidth]{figures/dipole_antenna}};
      \end{tikzpicture}

  \end{columns}
\end{frame}

\begin{frame}{The computational electromagneticist's toolbox}
  \vspace{-0.5cm}
  \begin{center}
    \input{figures/de_ie_mindmap}
  \end{center}
  \vspace{-1cm}
  Can we take advantage of IE discretization while reducing overall cost complexity?
\end{frame}

\begin{frame}{Integral equations}
  \begin{columns}
    \column{0.6\textwidth}
    \begin{block}{Convolutional propagation}
      \begin{equation*}
        \vb{E}(\vb{r}, t) = \vb{E}_\text{inc}(\vb{r}, t) + \mathfrak{g}(\vb{r}, t) * \vb{J}(\vb{r}, t)
      \end{equation*}
      \hfill \tiny{(applies to lots of physical potentials)}
    \end{block}

    \begin{block}{Discretized unknown quantity}
      \begin{equation*}
        \vb{J}(\vb{r}, t) \approx \sum_{t=1}^{N_t} \sum_{s=1}^{N_s} a_{ts} \, f_{ts}(\vb{r}, t)
      \end{equation*}
      \begin{itemize}
        \item Number of unknowns: $N_t, N_s \propto \omega_\text{max}, \omega_\text{max}^2$
        \item Cost to evaluate $\mathfrak{g}(\vb{r}, t) * \vb{J}(\vb{r}, t) \sim \mathcal{O}(N_t N_s^2)$
      \end{itemize}
    \end{block}

    \column{0.4\textwidth}
      \begin{center}
        \input{figures/dense_communication}
        {\small ``Everyone talking to everyone''}
      \end{center}
  \end{columns}
\end{frame}

\begin{frame}{More perspective}
  \begin{itemize}
    \item Electrically large objects: $N_s > 10^6$
    \item Memory required $\sim \mathcal{O}(N_s^2) \approx \SI{1}{\tera\byte}$
    \item Time required: $\mathcal{O}(N_s^3) \to \SI{1.26}{\year}$ (at \SI{25}{\giga\flops}, roughly single-core i7)
  \end{itemize}
  \begin{block}{Goal}
    \begin{center}
      Develop methods that scale as $\mathcal{O}(N_t N_s \log^\alpha N_s)$.
    \end{center}
    \begin{itemize}
      \item Exploit physical and mathematical structure
      \item Reduce cost (years to minutes)
      \item Control error (machine precision)
    \end{itemize}
  \end{block}
\end{frame}

\section{Fast methods for quantum optics}

\begin{frame}{Problem statement}
  \begin{columns}[t]
    \column{0.5\textwidth}
      \begin{block}{Task}
        Determine the response of $N_s$ \emph{active} radiators to a prescribed incident field.
      \end{block}
      \begin{block}{Challenges}
        \begin{itemize}
          \item $\vb{E}(\vb{r}, t) = \vb{E}_i(\vb{r}, t) + \mathfrak{g}(\vb{r}, t) * \vb{J}(\alert{\vb{E}(\vb{r}, t)})$
            \begin{itemize}
              \item $\vb{J}$ described by ODE
              \item Nonlinear sources
            \end{itemize}
          \item Multiphysics: EM + quantum
          \item Optical frequencies $\implies$ large $N_t$
          \item Random distribution of particles
        \end{itemize}
      \end{block}
    \column{0.5\textwidth}
    \begin{center}
      \input{figures/active_media}
    \end{center}
    \begin{block}{Next steps}
      \begin{itemize}
        \item Spatial acceleration: \checkmark
        \item Temporal acceleration: ?
      \end{itemize}
    \end{block}
  \end{columns}
\end{frame}

\begin{frame}{Temporal acceleration: frequency shifting}
  \begin{columns}
    \column{0.55\textwidth}
      \begin{itemize}
        \item System discretized by max frequency ($\Delta t \propto \omega_\text{max}^{-1}$)
        \item High frequency, narrow band implies $\vb{J}(t) \sim \tilde{\vb{J}}(t)\cos(\omega_0 t)$
        \item Formulate system for $\tilde{\vb{J}}(t)$ only (assumed $\cos(\omega_0 t)$)
        \item Interference recovered with a modified $\tilde{\mathfrak{g}}$
      \end{itemize}

    \column{0.45\textwidth}
      \vspace{0.5cm}
      \input{figures/pseudospin_periodogram}
  \end{columns}
\end{frame}

\begin{frame}{Spatial acceleration: uniform grid}
  \begin{columns}
    \column{0.75\textwidth}
      \begin{block}{Consider an easier problem (1D, without dynamics)}
        \begin{equation*}
          \vb{E}\qty(\vb{r}_\text{obs}) = \sum_\text{src} \mathfrak{g}\qty(\vb{r}_\text{obs}, \vb{r}_\text{src}) \rho\qty(\vb{r}_\text{src})
        \end{equation*}
      \end{block}
      \begin{itemize}
        \item Physics imposes translational invariance, symmetry: $\mathfrak{g}(\vb{r}_\text{obs}, \vb{r}_\text{src}) = \mathfrak{g}(\abs{\vb{r}_\text{obs} - \vb{r}_\text{src}})$
        \item Matrix with \emph{structure} (Toeplitz), diagonalized by Fourier transform (done quickly with \alert{FFT}, $\mathcal{O}(n \log n)$)
      \end{itemize}

      \begin{center}
        \begin{tikzpicture}[>=latex]
          \draw (0, 0) -- (10, 0);
          \foreach \x in {0,2,...,10}
            \draw (\x, -0.2) -- (\x, 0.2);

          \draw[<->] (0,0) to[out=30, in=150] node[midway, above] {$g_{12}$} (2,0);
          \draw[<->] (2,0) to[out=30, in=150] node[midway, above] {$g_{23}$} (4,0);
          \draw[<->] (4,0) to[out=30, in=150] node[midway, above] {$g_{34}$} (6,0);
          \draw[<->] (6,0) to[out=30, in=150] node[midway, above] {$g_{45}$} (8,0);
          \draw[<->] (8,0) to[out=30, in=150] node[midway, above] {$g_{56}$} (10,0);

          \draw[<->] (0,0) to[out=-30, in=210] node[midway, below] {$g_{13}$} (4,0);
          \draw[<->] (2,0) to[out=-30, in=210] node[midway, below] {$g_{24}$} (6,0);
          \draw[<->] (4,0) to[out=-30, in=210] node[midway, below] {$g_{35}$} (8,0);
          \draw[<->] (6,0) to[out=-30, in=210] node[midway, below] {$g_{46}$} (10,0);
        \end{tikzpicture}
      \end{center}

    \column{0.25\textwidth}
      \begin{center}
        \includegraphics[height=0.4\textheight]{figures/grid_1d}
        \begin{equation*}
          \vb{E} = \underbrace{\overbrace{G}^\text{FFT} \overbrace{\rho}^\text{FFT}}_\text{IFFT}
        \end{equation*}
      \end{center}
  \end{columns}
\end{frame}

\begin{frame}[b]{Spatial acceleration: nonuniform grid}
  \begin{columns}
    \column{0.75\textwidth}
      \textcolor{red!80!black}{Problem:} Sources do not lie on a uniform grid \\
      \textcolor{green!80!black}{Solution:} Represent them in terms of equivalent sources
      \begin{itemize}
        \item Can compress $\mathfrak{g}(\vb{r} - \vb{r}')$ for large distances; adjacent particles interact directly
        \item Sparse $\Lambda \to \mathcal{O}(n)$ projection
        \item Naturally extended to time-dependent systems, 3D
      \end{itemize}

      \begin{center}
        \begin{tikzpicture}[>=latex]
          \draw (0, 0) -- (10, 0);
          \foreach \x in {0,2,...,10}
            \draw (\x, -0.2) -- (\x, 0.2);

          \draw[<->, opacity=0.3] (0,0) to[out=30, in=150] node[midway, above] {$g_{12}$} (2,0);
          \draw[<->, opacity=0.3] (2,0) to[out=30, in=150] node[midway, above] {$g_{23}$} (4,0);
          \draw[<->, opacity=0.3] (4,0) to[out=30, in=150] node[midway, above] {$g_{34}$} (6,0);
          \draw[<->, opacity=0.3] (6,0) to[out=30, in=150] node[midway, above] {$g_{45}$} (8,0);
          \draw[<->, opacity=0.3] (8,0) to[out=30, in=150] node[midway, above] {$g_{56}$} (10,0);

          \draw[<->, opacity=0.3] (0,0) to[out=-30, in=210] node[midway, below] {$g_{13}$} (4,0);
          \draw[<->, opacity=0.3] (2,0) to[out=-30, in=210] node[midway, below] {$g_{24}$} (6,0);
          \draw[<->, opacity=0.3] (4,0) to[out=-30, in=210] node[midway, below] {$g_{35}$} (8,0);
          \draw[<->, opacity=0.3] (6,0) to[out=-30, in=210] node[midway, below] {$g_{46}$} (10,0);

          \node[fill, circle, red, inner sep=1pt] (p1) at (0.5, 0.3) {};
          \draw[->, red, very thick] (p1) -- (0, 0);
          \draw[->, red] (p1) -- (2, 0);

          \node[fill, circle, red, inner sep=1pt] (p2) at (3, -0.3) {};
          \draw[->, red, thick] (p2) -- (2, 0);
          \draw[->, red, thick] (p2) -- (4, 0);
          
          \node[fill, circle, red, inner sep=1pt] (p3) at (6.5, 0.3) {};
          \node[fill, circle, red, inner sep=1pt] (p4) at (7.2, -0.3) {};
          \draw[->, red, very thick] (p3) -- (6, 0);
          \draw[->, red] (p3) -- (8, 0);
          \draw[->, red] (p4) -- (6, 0);
          \draw[->, red, very thick] (p4) -- (8, 0);

          \node[fill, circle, red, inner sep=1pt] (p5) at (10.0, 0.5) {};
          \draw[->, red, very thick] (p5) -- (10, 0);
        \end{tikzpicture}
      \end{center}

    \column{0.25\textwidth}
      \begin{center}
        \includegraphics[height=0.4\textheight]{figures/dense_1d}
        \begin{equation*}
          \vb{E} = \textcolor{red}{\Lambda^T} \underbrace{\overbrace{G}^\text{FFT} \overbrace{\textcolor{red}{\Lambda} \rho}^\text{FFT}}_\text{IFFT}
        \end{equation*}
      \end{center}
  \end{columns}
\end{frame}

\begin{frame}{Layered redundancies}
  \begin{center}
    Algorithmic complexity: $\displaystyle\mathcal{O}(N_t N_s^2) \to$ \alert{(years)}
  \end{center}
  \begin{block}{Neglect high frequencies}
    High-frequency terms barely affect dynamics; downshift to baseband.
  \end{block}
  \begin{block}{Fewer degrees-of-freedom}
    $\mathfrak{g}(\vb{r}, \vb{r}'; t, t')$ compressible; aggregate adjacent sources and transmit once.
  \end{block}
  \begin{block}{Imposed translational invariance}
    $\mathfrak{g}(\vb{r}, t) * \vb{J}(\vb{r}, t)$ structured on grid; FFT accelerates $\iint_{}\mathfrak{g}(\vb{r} - \vb{r}', t - t') \vb{J}(\vb{r'}, t') \dd[3]{\vb{r}'} \dd{t'}$.
  \end{block}
  \begin{center}
    Optimal algorithmic complexity: $\displaystyle\mathcal{O}\qty(\frac{N_t}{\alpha} N_s \log N_s) \to$ \alert{(minutes)}
  \end{center}
\end{frame}

\begin{frame}{Frame comparison}
  \begin{columns}
    \column{0.4\textwidth}
      \begin{itemize}
        \item Evolution of 10k particles
        \item $\vb{J}$ derived from $\rho$
        \item Comparison of single trajectory before/after downshifting
      \end{itemize}

      \vspace{0.5cm}
      \begin{tikzpicture}[node distance=0.8cm, >=latex]
        \tikzstyle{physics} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=blue!10]
        \tikzstyle{engineering} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=red!10]
        \tikzstyle{arrow} = [thick,->,>=stealth]

        \node (quantum) [physics, align=center] {Integrate ODE to advance $\hat{\rho}$ by $\Delta t$; \\ Feed $\vb{J}$ into Maxwell as new source};
        \node (em) [engineering, below= of quantum, align=center] {Convolve currents to propagate $\vb{E}$; \\ Feed into Liouville as new RHS};

        \draw [arrow] ($(quantum.south)+(1.0,0)$) -- ($(em.north)+(1.0,0)$);
        \draw [arrow] ($(em.north)-(1.0,0)$) -- ($(quantum.south)-(1.0,0)$);
      \end{tikzpicture}

    \column{0.6\textwidth}
      \begin{center}
        \input{figures/frame_comparison}
      \end{center}
  \end{columns}
\end{frame}


\begin{frame}{Collective dynamics}
  \begin{center}
    \input{figures/density_stats}
  \end{center}
\end{frame}

\begin{frame}{``Current'' hotspots (energy confinement)}
  \vspace{-0.3cm}
  \begin{center}
    \begin{tikzpicture}
      \begin{axis}[
          hide axis,
          scale only axis,
          height=0pt,
          width=0pt,
          colormap/viridis,
          colorbar horizontal,
          point meta min=0.32,
          point meta max=0.40,
          colorbar style={
              title style={yshift=-0.80cm, color=white},
              title=Spatial distribution of $\rho_{00}$,
              width=0.75\textwidth,
              xtick={0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.40},
              xticklabels={$\le 0.32$, $0.33$, $0.34$, $0.35$, $0.36$, $0.37$, $0.38$, $0.39$, $0.40 \le$}
          }]
          \addplot [draw=none] coordinates {(0,0)};
      \end{axis}
    \end{tikzpicture} 
    \begin{tikzpicture}[>=latex]
      \draw[thick, ->] (-6.5,0) -- (-6.5,-4.5) node[midway, above, rotate=90]{Time};
      \node (tube0) at (0,-0.0) {\includegraphics[width=0.9\textwidth]{figures/tube/tube_print_0}};
      \node (tube1) at (0,-1.5) {\includegraphics[width=0.9\textwidth]{figures/tube/tube_print_1}};
      \node (tube2) at (0,-3.0) {\includegraphics[width=0.9\textwidth]{figures/tube/tube_print_2}};
      \node (tube3) at (0,-4.5) {\includegraphics[width=0.9\textwidth]{figures/tube/tube_print_3}};
      %\draw[->] (6.5,0) -- (6.5,-4.5) node[midway, above, rotate=-90]{Time};
      \path[->] (7.5,0) -- (7.5,-4.5);
    \end{tikzpicture} 
  \end{center}
\end{frame}

\begin{frame}{Future work}
  \begin{itemize}
    \item Additional dynamical systems (nanomagnetics, biexcitons, degenerate states)
    \item Development of isotemporal model (same basis functions for integration, interpolation)
    \item Improved grid representations ($\delta$-function representation in terms of Legendre polynomials?)
    \item Multi-level FFT-based propagation
    \item Extremely large systems (MPI and/or GPU)
  \end{itemize}
\end{frame}

\section{QuEST}

\begin{frame}{Software features}
  \begin{columns}
    \column{0.5\textwidth}
      \begin{itemize}
        \item Modern C++
        \item CMake
        \item Object-oriented
          \begin{itemize}
            \item Integrator, RHS function
            \item Interactions
            \item Assistance classes
          \end{itemize}
        \item Unit tests
        \item Additional tools
          \begin{itemize}
            \item Data manipulation
            \item Visualization
            \item Math
          \end{itemize}
        \item Clang-format
        \item Developed on git
      \end{itemize}

    \column{0.5\textwidth}
      \begin{center}
        \vspace{-0.5cm}
        \href{https://www.github.com/cglosser/quest}{
          \includegraphics[width=\textwidth]{figures/github.png}
        }
        \url{https://github.com/cglosser/quest}
      \end{center}
  \end{columns}
\end{frame}

\begin{frame}{Hierarchy}
  \begin{center}
    \begin{tikzpicture}[node distance=0.8cm, >=latex]
      \tikzstyle{physics} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=blue!10]
      \tikzstyle{engineering} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=red!10]
      \tikzstyle{both} = [rectangle, rounded corners, minimum width=3cm, minimum height=1cm,text centered, draw=black, fill=Fuchsia!20]
      \tikzstyle{arrow} = [thick,->,>=stealth]

      \node (quest) [both] {\textbf{QuEST}};
      \node (ode) [physics, below= of quest] {ODE};
      \node (radiation) [engineering, right= of quest] {Radiation};

      \draw [arrow] (ode) -- (quest);
      \draw [arrow] (radiation) -- (quest);

      \node (interactions) [engineering, below= of radiation] {Interactions};
      \node (integration) [physics, below= of ode] {Integration};
      \node (rhs) [physics, below= of integration] {RHS functions};
      \node (history) [both, right= of rhs] {History};

      \draw [arrow] (interactions) -- (radiation);
      \draw [arrow] (integration) -- (ode);
      \draw [arrow] (history) -- (integration);
      \draw [arrow] (rhs) -- (integration);

      \node (pulse) [engineering, right= of radiation] {Pulse};

      \draw [arrow](pulse) -- (interactions);

      \node (direct) [engineering, right= of interactions] {Direct};
      \node (interpolation) [engineering, below= of interactions] {Interpolation};
      \node (aim) [engineering, below= of direct] {AIM};

      \node (fft) [engineering, below= of aim] {FFT};

      \draw [arrow] (history) -- (interpolation);
      \draw [arrow] (interpolation) -- (interactions);
      \draw [arrow] (direct) -- (interpolation);
      \draw [arrow] (aim) -- (interpolation);
      \draw [arrow] (fft) -- (aim);

    \end{tikzpicture}
  \end{center}
\end{frame}

\begin{frame}{Pedigree}
  \begin{itemize}
    \item Senior member of EM research group at MSU
      \begin{itemize}
        \item Composed of theorists, computationalists, experimentalists
      \end{itemize}
    \item ``Hands-on'' electromagnetics
      \begin{itemize}
        \item Design of fast algorithms \emph{and} (real) novel structures
        \item Tips, techniques, discussions, back-of-the-envelopes, whiteboards, at-length investigations, etc.
      \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Things I've worked on}
  \begin{itemize}
    \item Radiation models (quantum optics: QuEST)
      \begin{itemize}
        \item Rank-deficient fast methods, performance optimization, tree codes, FFTs, GPUs
      \end{itemize}
    \item Molecular dynamics (acoustic trapping, hydrocarbon bonding)
    \item Nanostructure inverse problem, reconstruction (Tribond)
    \item Computational physics education
      \begin{itemize}
        \item \textbf{I}nternational \textbf{C}ourse in \textbf{C}omputational \textbf{P}hysics
        \item Course development, teaching assistantships
        \item Introductory workshops (highschool and college level)
      \end{itemize}
  \end{itemize}
\end{frame}
\appendix

\begin{frame}[standout]
  Questions?
\end{frame}

\begin{frame}{Units}
  \begin{table}
    \begin{tabular}{lll}
      Quantity                 & Symbol            & Value                        \\ \hline \hline
      Speed of light           & $c$               & \SI{300}{\micro\meter \per \pico\second} \\
      Transition frequency     & $\omega_0$        & $\SI{1500}{\milli\eV}/\hbar$ \\
      Transition dipole moment & $\vb{d}$          & \SI{10}{\elementarycharge\bohr} (uniform) \\
      Relaxation times         & $T_{1}, T_{2}$    & \SIlist{10;20}{\pico\second} \\
      Laser frequency          & $\omega_L$        & $\SI{1500}{\milli\eV}/\hbar$ \\
      Laser wavevector         & $\vb{k}_L$        & $\omega_L/c$ ($\vb{k}_L \cdot \vb{d} = 0$) \\
      Pulse width              & $\sigma/\omega_L$ & \SI{1}{\pico\second} \\ \hline
      Integrator window        & $W$               & 20 \\
      Corrector iterations     & N/A               & max 10 (usually 4-6) \\
      Timestep                 & $\Delta t$        & \SI{0.5e-2}{\pico\second}
    \end{tabular}
  \end{table}
\end{frame}

\begin{frame}{Lightning review of (linear) Green's functions}
  \only<1>{
    To solve the following differential equation for $a(x)$ \ldots
    \begin{equation*}
      \hat{\mathcal{L}}\qty[a(x)] = b(x)
    \end{equation*}
    \ldots it's far easier to \emph{first} find the Green's function,
    \begin{equation*}
      \hat{\mathcal{L}}\qty[g(x, x')] = \delta(x - x').
    \end{equation*}
    Then,
    \begin{align*}
      \hat{\mathcal{L}}\qty[a(x)] &= \int_{} \delta(x - x') b(x') \dd{x'} \\
                                  &= \int_{} \hat{\mathcal{L}}\qty[g(x, x')] b(x') \dd{x'} \\
                     \Aboxed{a(x) &= \int_{} g(x, x') b(x') \dd{x'}}
    \end{align*}
  }
  \only<2>{
    \begin{block}{Laplace equation}
      \begin{equation*}
        \laplacian g(\vb{r}, \vb{r}') = -4 \pi \delta(\vb{r} - \vb{r}') \implies g(\vb{r}, \vb{r}') = \frac{1}{\abs{\vb{r} - \vb{r}'}}
      \end{equation*}
    \end{block}

    \begin{block}{Wave equation}
      \begin{equation*}
        \qty(\laplacian - \frac{1}{c^2}\pdv[2]{t}) g^{(4)} = -4 \pi \delta^{(4)} \implies g(\vb{r}, t; \vb{r}', t') = \frac{1}{\abs{\vb{r} - \vb{r}'}} \delta\qty(t - t' - \frac{\abs{\vb{r} - \vb{r}'}}{c})
      \end{equation*}
    \end{block}
  }
\end{frame}

\begin{frame}{An electric-field wave equation}
  \vspace{0.7cm}
  \begin{columns}
    \column{0.6\textwidth}
        \begin{equation*}
          \laplacian{\pdv{\vb{E}}{t}} - \frac{1}{c^2} \pdv[3]{\vb{E}}{t} = 4 \pi k_2 \qty(\pdv[2]{\vb{J}}{t} - c^2 \grad \div \vb{J})
        \end{equation*}
        \begin{itemize}
          \item Incorporates short and long-range effects
          \item Automatic radiation boundary conditions
          \item Point-to-point communication; no numerical dispersion
          \item \alert{Four} derivatives, two spatial and two temporal
        \end{itemize}

    \column{0.4\textwidth}
      \centering
      \includegraphics[width=0.5\textwidth]{figures/dipoles_2.png}
  \end{columns}

  \begin{equation*}
    \mathfrak{F}\qty{\vb{P}(\vb{r}, t)} = -k_2 \int_{}
        \left(\overline{\mathbf{I}} -  \hat{\mathbf{r}}\hat{\mathbf{r}}\right) \cdot \frac{\ddot{\mathbf{P}}(\vb{r}, t_R)}{\left|\mathbf{r}-\mathbf{r}'\right|} +
        \left(\overline{\mathbf{I}} - 3\hat{\mathbf{r}}\hat{\mathbf{r}}\right) \cdot \qty(
          \frac{c\dot{\mathbf{P}}(\vb{r}, t_R)}{\left|\mathbf{r}-\mathbf{r}'\right|^2} +
          \frac{c^2   \mathbf{P}(\vb{r}, t_R)}{\left|\mathbf{r}-\mathbf{r}'\right|^3}
        )
      \, \mathrm{d}^3 \mathbf{r'}
  \end{equation*}
\end{frame}

\begin{frame}{Classical electrodynamics: procedureally solving a matrix equation}
  \begin{block}{Marching-on-in-Time}
    \begin{equation*}
    \oper{L}^{(m)} + \sum_{k = 0}^m \oper{Z}^{(k)} \oper{A}^{(m-k)} = \oper{F}^{(m)}; \quad \oper{A}^{(m)}_n = \Trace\!\qty[\hat{\rho}_n(m \, \Delta t) \cdot \hat{\vb{d}}_n]
    \end{equation*}
  \end{block}

  \vspace{-0.5cm}
  \begin{equation*}
    \underbrace{\mqty(\oper{L}^{(0)} \\ \oper{L}^{(1)} \\ \oper{L}^{(2)} \\ \oper{L}^{(3)} \\ \oper{L}^{(4)})}_\text{Laser} +
    \underbrace{\mqty(
      \oper{Z}^{(0)} \\
      \oper{Z}^{(1)} & \oper{Z}^{(0)} \\
      \oper{Z}^{(2)} & \oper{Z}^{(1)} & \oper{Z}^{(0)} \\
      \oper{Z}^{(3)} & \oper{Z}^{(2)} & \oper{Z}^{(1)} & \oper{Z}^{(0)} \\
                                & \oper{Z}^{(3)} & \oper{Z}^{(2)} & \oper{Z}^{(1)} & \oper{Z}^{(0)} \\
      )}_\text{Interaction weights (precalculated)} \cdot
    \underbrace{\mqty(\oper{A}^{(0)} \\ \oper{A}^{(1)} \\ \oper{A}^{(2)} \\ \oper{A}^{(3)} \\ \oper{A}^{(4)})}_\text{Sources} =
    \underbrace{\mqty(\oper{F}^{(0)} \\ \oper{F}^{(1)} \\ \oper{F}^{(2)} \\ \oper{F}^{(3)} \\ \oper{F}^{(4)})}_\text{Total field}
  \end{equation*}

  \begin{equation*}
    \oper{L}^{(m)}_\ell = \langle\vb{S}_\ell(\vb{r}), \vb{E}_L (\vb{r}, m\, \Delta t)\rangle \quad
    \oper{Z}^{(k)}_{\ell\ell'} = \langle\vb{S}_\ell(\vb{r}), \mathfrak{F}\qty{\vb{S}_{\ell'}(\vb{r})T(k \, \Delta t)}\rangle \quad
    \oper{F}^{(m)}_\ell = \langle\vb{S}_\ell(\vb{r}), \vb{E} (\vb{r}, m\, \Delta t)\rangle
  \end{equation*}
\end{frame}

\begin{frame}{Interpolation influence}
  \begin{columns}
    \column{0.45\textwidth}
      \begin{center}
        \includegraphics[height=0.85\textheight]{figures/spheres_of_influence}
      \end{center}

    \column{0.55\textwidth}
      \begin{itemize}
        \item Interpolate $\rho$, $\vb{P}$ due to $\abs{\vb{r} - \vb{r}'}/c \, \not \in \mathbb{N}$
        \item Sufficiently high order to recover $\partial_t^2 \vb{P}$, $\partial_t \vb{P}$, $\vb{P}$
        \item Time-domain solution imposes causality requirement: $T(t) = 0 \, \forall \, t < -1$
      \end{itemize}
  \end{columns}
\end{frame}

\begin{frame}{Simulated quantum dot = two-level quantum system}
  \begin{columns}
    \column{0.5\textwidth}
      \begin{block}{Liouville equation}
        \begin{equation*}
          \dv{\hat{\rho}}{t} = \frac{-i}{\hbar} \commutator{\hat{\mathcal{H}}(t)}{\hat{\rho}} - \hat{\mathcal{D}}\qty[\hat{\rho}]
        \end{equation*}
        \hfill {\tiny(mixed-state analogue of Schr\"odinger equation)}
      \end{block}

      \begin{itemize}
        \item Density matrix representation
        \item $\hat{\mathcal{D}}[\hat{\rho}]$ (phenomenologically) incorporates decay and decoherence
        \item Rabi oscillations
        \item One wavefunction/dot
          \begin{itemize}
            \item No universal wavefunction
            \item \emph{Classical} electromagnetic propagation
          \end{itemize}
      \end{itemize}

    \column{0.5\textwidth}
      \begin{center}
        \input{figures/example_evolution}
      \end{center}

      \vspace{-1.0cm}
      \begin{align*}
        \hat{\mathcal{H}}(t) &\equiv \mqty(0 & \vb{d} \cdot \vb{E}(t) \\ \vb{d}^* \cdot \vb{E}^*(t) & \hbar \omega_0) \\
        \hat{\mathcal{D}}[\hat{\rho}] &\equiv \mqty( (\rho_{00} - 1)/T_1 & \rho_{01}/T_2 \\ \rho_{10}/T_2 & \rho_{11}/T_1)
      \end{align*}
  \end{columns}
\end{frame}

\begin{frame}{Quantum transitions are spectrally pure}
  \includegraphics[width=\textwidth, height=0.5cm]{figures/Helium_spectrum_visible}
      \begin{block}{Liouville equation (rotating frame)}
        \begin{gather*}
          \dv{\tilde{\rho}}{t} = -\frac{i}{\hbar} \commutator{\hat{U}\hat{\oper{H}}\hat{U}^\dagger - i\hbar \hat{V}}{\tilde{\rho}} - \hat{\oper{D}}\qty[\tilde{\rho}]; \quad \hat{U} = \mathrm{diag}(1, e^{i \omega_L t}), \quad \hat{V} = \hat{U} \dv{\hat{U}}{t}
        \end{gather*}
      \end{block}

      \begin{gather*}
        \tilde{\mathfrak{F}}\{\tilde{\vb{P}}(\vb{r}, t) \} \equiv -k_2 \int_{}
        \qty(\mathrm{I} -  \outerprod{\bar{\vb{r}}}{\bar{\vb{r}}} ) \cdot \frac{\qty(\partial_t^2 \tilde{\vb{P}}(\vb{r}', t_R) + 2 i \omega_L \partial_t \tilde{\vb{P}}(\vb{r}', t_R) - \omega_L^2 \tilde{\vb{P}}(\vb{r}', t_R)) \alert{e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}}{c^2 \abs{\vb{r}-\vb{r}'}} + \\
        \qty(\mathrm{I} - 3\outerprod{\bar{\vb{r}}}{\bar{\vb{r}}} ) \cdot \frac{\qty(\partial_t \tilde{\vb{P}}(\vb{r}', t_R) + i \omega_L \tilde{\vb{P}}(\vb{r}', t_R))\alert{e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}}{c \abs{\vb{r}-\vb{r}'}^2} +
        \qty(\mathrm{I} - 3\outerprod{\bar{\vb{r}}}{\bar{\vb{r}}} ) \cdot \frac{                \tilde{\vb{P}}(\vb{r}', t_R) \alert{e^{-i \omega_L \abs{\vb{r} - \vb{r}'}/c}}}{\abs{\vb{r}-\vb{r}'}^3}
        \, \dd[3]{\vb{r'}}
      \end{gather*}
\end{frame}

\begin{frame}{Solution methodology}
  \begin{enumerate}
    \item Predict $\hat{\mathbf{\rho}}(t + \Delta t)$
      \begin{enumerate}
        \item Map $\hat{\mathbf{\rho}}(t + \Delta t)$ to $\vb{P}(\vb{r}, t + \Delta t)$
      \end{enumerate}
    \item Calculate $\vb{E}(\vb{r}, t + \Delta t) = \mathfrak{F}\qty{\vb{P}(\vb{r}, t + \Delta t)}$
      \begin{itemize}
        \item retardation, interpolation, causality, derivatives
      \end{itemize}
    \item Use $\displaystyle \vb{E}(\vb{r}, t + \Delta t)$ to calculate $\displaystyle \partial_t \hat{\rho} = -\frac{i}{\hbar} \commutator{\hat{\mathcal{H}}\qty\big(\vb{E}(t + \Delta t))}{\hat{\rho}(t + \Delta t)} - \hat{\mathcal{D}}\qty[\hat{\rho}(t + \Delta t)]$
    \item Use $\partial_t \hat{\rho}$ to correct $\hat{\rho}(t + \Delta t)$
  \end{enumerate}

  \begin{block}{Predictor/corrector}
    \begin{equation*}
    \hat{\rho}(t_{m + 1}) \leftarrow \sum_{w = \alert{-1}}^{W - 1} \qty{\mathcal{P}_{w}^{(0)} / \mathcal{C}_{w}^{(0)}} \hat{\rho}(t_{m-w}) + \qty{\mathcal{P}_{w}^{(1)}/ \mathcal{C}_{w}^{(1)}} \, \partial_t \hat{\rho}(t_{m - w}) \qquad
    \end{equation*}
  \end{block}
\end{frame}

\begin{frame}{Determination of the $\Lambda$s}
  \begin{block}{Multipole expansion}
    \begin{equation*}
      \underbrace{\int_{} \psi_i(\vb{r}) (x - x_0)^{m_x} (y - y_0)^{m_y} (z - z_0)^{m_z}}_{Q_{i\vb{m}}} - \sum_{\vb{u} \in C_i} \Lambda_{i \vb{u}} \underbrace{\delta(\vb{r} - \vb{u}) \dd[3]{\vb{r}}}_{W_{\vb{m}\vb{u}}} = 0
    \end{equation*}
  \end{block}
  \begin{columns}
    \column{0.7\textwidth}
      \begin{itemize}
        \item Grid discretization sufficient to recover $k_0 = \omega_0/c$ spatial variation
        \item Instantaneous ``propagation'' from source to grid
        \item Recover $\grad \div \vb{J}$ from $\grad \div Q_{i\vb{m}}$
      \end{itemize}

    \column{0.3\textwidth}
      \begin{block}{Least-squares fit}
        \begin{equation*}
          \sum_{\vb{u} \in C_i} W_{\vb{m}\vb{u}} \Lambda_{i \vb{u}} = Q_{i\vb{m}}
        \end{equation*}
      \end{block}
  \end{columns}
\end{frame}

\end{document}
